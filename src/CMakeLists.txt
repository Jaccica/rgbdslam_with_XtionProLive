set( CMAKE_BUILD_TYPE Debug )
#Enable support for C++11
SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++11")

# 增加PCL库的依赖
FIND_PACKAGE( PCL REQUIRED COMPONENTS common io visualization filters )

# 增加opencv的依赖
FIND_PACKAGE( OpenCV REQUIRED )
#INCLUDE_DIRECTORIES( ${OpenCV2_INCLUDE_DIRS}  )
#LINK_LIBRARIES( ${OpenCV_LIBS} )

set(LIB_CXSPARSE  /usr/lib/libcxsparse.so)

# 添加头文件和库文件
ADD_DEFINITIONS( ${PCL_DEFINITIONS} )
INCLUDE_DIRECTORIES( ${PCL_INCLUDE_DIRS}  )
LINK_LIBRARIES( ${PCL_LIBRARY_DIRS} )

LIST( APPEND CMAKE_MODULE_PATH ${PROJECT_SOURCE_DIR}/cmake_modules )
FIND_PACKAGE( G2O REQUIRED)
MESSAGE( "\n ===========G2O_INCLUDE_DIRS:${G2O_INCLUDE_DIR} \n" )
MESSAGE( "\n ===========G2O_LIBRARY_DIRS:${G2O_LIBRARY} \n" )
set(G2O_LIBS ${G2O_CLI_LIBRARY}
     ${G2O_CORE_LIBRARY}
     ${G2O_STUFF_LIBRARY}
     ${G2O_TYPES_SLAM2D}
     ${G2O_TYPES_SLAM3D}
     ${G2O_SOLVER_CHOLMOD}
     ${G2O_SOLVER_CSPARSE}
     ${G2O_SOLVER_CSPARSE_EXTENSION}
     ${G2O_CSPARSE_EXTENSION}
     ${G2O_EXT_CSPARSE}
     ${G2O_INCLUDE_DIR}
     ${G2O_SIMULATOR}
     ${G2O_SOLVER_DENSE}
     #${G2O_SOLVER_EIGEN} #编译不通过
     ${G2O_SOLVER_PCG}
     ${G2O_SOLVER_SLAM2D_LINEAR}
     ${G2O_SOLVER_STRUCTURE_ONLY}
     ${G2O_TYPES_DATA}
     ${G2O_TYPES_ICP}
     ${G2O_TYPES_SBA}
     ${G2O_TYPES_SCLAM2D}
     ${G2O_TYPES_SIM3}
)

#EIGEN
FIND_PACKAGE(Eigen3 REQUIRED)
INCLUDE_DIRECTORIES(${EIGEN3_INCLUDE_DIR})

# CSparse
FIND_PACKAGE( CSparse )
INCLUDE_DIRECTORIES( ${G2O_INCLUDE_DIR} ${CSPARSE_INCLUDE_DIR})
INCLUDE_DIRECTORIES(${CSPARSE_INCLUDE_DIR})

#openni
#INCLUDE_DIRECTORIES(${OPEN_NI_INCLUDE})
#LINK_LIBRARIES(${OPEN_NI_LIB32})
#set(LIB_OPENNI  /usr/lib/libOpenNI.so)

ADD_LIBRARY( slambase slamBase.cpp )
TARGET_LINK_LIBRARIES( slambase
    ${OpenCV_LIBS} 
    ${PCL_LIBRARIES} )

ADD_EXECUTABLE(main main.cpp)
TARGET_LINK_LIBRARIES(main slambase 
	${OpenCV_LIBS} 
	${PCL_LIBRARIES} 
	${G2O_LIBS}
 	${CSPARSE_LIBRARY})


